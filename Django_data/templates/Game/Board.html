{% load static %}
<!DOCTYPE html>
<html>
  {% include "Home/head.html" %}
  <body>
    {% include "Profile/Avatar.html" %}
    {% include "Profile/Profile.html" %}
    {% include "Auth/code_validation.html" %}
    {% include "Profile/enable_2fa.html" %}
    {% include "FriendList/FriendsList.html" %}
    <header>
      <div id="Header_content"></div>
    </header> 
    <div id="content">
      <div id="overlay">
      	<div class="mid midcolumn flowAnimation">
          <div id="titleContent" data-content="GAMEBOARD_PAGE"></div>
          <div class="section-stats">
            <h1 class="gameStats">Game Stats</h1>
          </div>
                  <div class="section-stats">
                    {% if me.winner %}
                      <div class="winner-loser">
                        <span id="WR" class="stats-title">Winner</span>
                        <span class="stats-title">Loser</span>
                      </div>
                    {% else %}
                      <div class="winner-loser">
                        <span class="stats-title">Loser</span>
                        <span id="WR" class="stats-title">Winner</span>
                      </div>
                    {% endif %}
                    <div class="winner-loser">
                      <div id="STATS_user">
                        <img id="HEADER_GameProfilePicLeft" class="ProfilePic header-profilePic profilePic-left" src="{{ me.user.avatar.url }}" alt="Very basic user"></img>
                        <h1 class="username" id="GAME_username_left">{{ me.user.username }}</h1>
                      </div>
                      <div id="STATS_user">
                        <img id="HEADER_GameProfilePicLeft" class="ProfilePic header-profilePic profilePic-left" src="{{ opponent.user.avatar.url }}" alt="Very basic user"></img>
                        <h1 class="username" id="GAME_username_right">{{ opponent.user.username }}</h1>
                      </div>
                    </div>
                  </div>
                  <div class="section-stats">
                    <span class="stats-title">Score</span>
                  </div>
                  <div class="content-score">
                  
                    <div class="pk-wrapper">
                      <div id="left" class=" rantangle left">
                        <span id="score-left">{{ me.score }}</span>
                      </div>
                      <div id="right" class="rantangle right">
                        <span id="score-right">{{ opponent.score }}</span>
                      </div>
                    </div>
                  
                  </div>

                  <div class="skills">
                    <ul class="lines">
                      <li class="line l--0">
                        <span class="line__label">
                          0
                        </span>
                      </li>
                      <li class="line l--25">
                        <span class="line__label">
                          25
                        </span>
                      </li>
                      <li class="line l--50">
                        <span class="line__label">
                          50
                        </span>
                      </li>
                      <li class="line l--75">
                        <span class="line__label">
                          75
                        </span>
                      </li>
                      <li class="line l--100">
                        <span class="line__label">
                          100
                        </span>
                      </li>
                    </ul>
                    
                    <div class="charts">
                      <span class="chart__title">Ball : max speed</span>
                      <div class="chart chart--dev">
                        <ul class="chart--horiz">
                          <li class="chart__bar" style="width: 98%;">
                            <span class="chart__label">
                              {{ me.user.username }}
                            </span>
                          </li>
                          <li class="chart__bar" style="width: 50%;">
                            <span class="chart__label">
                              {{ opponent.user.username }}
                            </span>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>

                  <div class="section-stats">
                    <span class="stats-title">Wall bounces: {{ game.bounce }}</span>
                  </div>
                  <div class="section-stats">
                    <span class="stats-title">Max exchanges: {{ game.max_exchange }}</span>
                  </div>
                  <div class="section-stats">
                    <span class="stats-title">Duration: {{ game.duration }} secs</span>
                  </div>

                  <div id="NbRounds">{{ game.nb_rounds }}</div>
          </div>
        </div>
      </div>
    </div>
    {% include "Home/footer.html" %}
  {% comment %} <script>
    const elL = document.getElementById("left");
    const elR = document.getElementById("right");
    
    let scoreL = document.getElementById('score-left').textContent;
    let scoreR = document.getElementById('score-right').textContent;

    // Conversion des scores en nombres si nécessaire
    scoreL = parseInt(scoreL, 10);
    scoreR = parseInt(scoreR, 10);

      let totalRounds = document.getElementById('NbRounds').textContent;
      totalRounds = parseInt(totalRounds, 10);
        
      // Calculer le pourcentage de progression pour chaque joueur
    function calculateProgress(score, totalRounds) {
      // Si le score est 0, retourner 1% pour indiquer une petite progression
      if (score === 0) {
          return 5;
      }
      // Sinon, calculer le pourcentage normal
      return (score / totalRounds) * 100;
    }

    // Mettre à jour la barre de progression pour chaque joueur
    function updateProgressBar(score, progressBarId) {
      let progressPercentage = calculateProgress(score, totalRounds);
      progressBarId.style.width = `${progressPercentage}%`;
    }

    // Mettre à jour les barres de progression
    updateProgressBar(scoreL, elL);
    updateProgressBar(scoreR, elR);

    // Afficher les scores
    elL.children[0].innerText = scoreL;
    elR.children[0].innerText = scoreR;
  </script>
   {% endcomment %}
  </body>
</html>


